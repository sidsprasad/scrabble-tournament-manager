<!DOCTYPE html>
<html lang="en">
<head>
    <% include ../partials/head %>
</head>
<body>
<header>
    <% include ../partials/header %>
</header>

<main>
	<style type="text/css">
		.login-form {
			width: 340px;
	    	margin: 50px auto;
		}
	    .login-form form {
	    	margin-bottom: 15px;
	        background: #f7f7f7;
	        box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);
	        padding: 30px;
	    }
	    .login-form h2 {
	        margin: 0 0 15px;
	    }
	    .form-control, .btn {
	        min-height: 38px;
	        border-radius: 2px;
	    }
	    .btn {        
	        font-size: 15px;
	        font-weight: bold;
	    }
	</style>
    <div class="login-form">
    <form>
        <h2 class="text-center">Log in</h2>       
        <div class="form-group">
            <input type="text" class="form-control" placeholder="Username" required="required" id="username">
        </div>
        <div class="form-group">
            <input type="password" class="form-control" placeholder="Password" required="required" id="password">
        </div>
        <div class="form-group">
            <button type="button" class="btn btn-primary btn-block" id="login-button">Log in</button>
        </div>
        <div class="clearfix">
            <label class="pull-left checkbox-inline"><input type="checkbox"> Remember me</label>
        </div>  
        <br>
        <div class="text-center"><a href="#" class="pull-right">Forgot Password?</a></div>      
    </form>
    
    <p class="text-center"><button type="button" class="btn btn-secondary btn-block">Request for an Account</button></p>
</div>
</main>

<footer>
    <% include ../partials/bottom-bar-empty %>
</footer>

	<% include ../scripts/global-scripts %>

	<script type="text/javascript">
		$("#login-button").click(function(){
			username = $("#username").val();
			password = $("#password").val();
			params = {
				username: username,
				pass: password
			};
			$.post("<%= domainName %>/api/auth", params, function(data, status) {
				//alert("Data: " + data + "\nStatus: " + status);
				if (status=='success') {
					token = data.token;
					var d = new Date();
    				d.setTime(d.getTime() + (24*60*60*1000));
					var expires = "expires="+ d.toUTCString()

					document.cookie = "username=" + username + ";" + expires + ";path=/";
					document.cookie = "token=" + token + ";" + expires + ";path=/";
					
					window.location.href = "<%= domainName %>/tournaments";
					//alert(document.cookie);

				}
			}).fail(function(response) {
			    alert('Error: ' + response.responseText);
			});
		});
	</script>
</body>
</html>